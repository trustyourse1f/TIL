# 4. 회귀
## 단순 선형 회귀

### 단순 선형 회귀의 개요

- 회귀의 목표는 연속형 반응 변수의 값을 예측하는 것
- 단순 선형 회귀란 설명 변수인 당닐 특징과 단일 반응 변수 간에 선형 관계가 있다고 가정하고 초평면이라고 하는 선형 평면을 이용해 모델링한 것
- 단순 회귀는 설명 변수의 차원과 반응 변수의 차원, 모두 2개의 차원을 가지며 초평면은 한 차원 낮은 1차원이 됨(1차원의 초평면은 선)

![image-20220504195516820](https://user-images.githubusercontent.com/102509786/166672621-7c19c3fc-d19c-479d-a523-218e5483e304.png)

알고리즘을 통해 학습하면 최적의 α와 β 값을 찾아냄

y : 반응 변수의 예측 값

절편 항 α와 계수 β  : 알고리즘을 통해 학습하게 되는 모델의 파라미터

x : 설명 변수



### 최소 제곱법

- OLS(Ordinary Least Squares) 또는 LLS(Linear Least Squares)로 부름
- 단순 선형 회귀에서 모델을 최적화하는 파라미터 값을 훈련 데이터로부터 학습하는 방법
- 비용 함수 : 손실 함수. 모델의 오차를 정의하고 측정하기 위해 사용
- 잔차 : residual. 훈련 오차로 훈련 데이터의 관측 값과 모델에 의한 예측 값의 차이
- 예측 오차 :  prediction error. 테스트 오차로 테스트 데이터의 관측 값과 모델에 의한 예측 값의 차이
- 잔차의 합을 최소화 -> 값을 예측할 수 있는 추정기를 만들 수 있음



### 비용함수를 사용한 모델의 적합화 척도 : RSS

- 반응 변수의 예측 값이 훈련 데이터의 관측 값과 가까워지면 모델이 적합화되었다고 할 수 있음
- 모델 적합화의 척도 : 잔차 제곱 합 (RSS. Residual Sum of Squares)


![image-20220504200236712](https://user-images.githubusercontent.com/102509786/166672633-0f548cfd-0c91-48ed-85ba-7da03945b08f.png)

yi  : i번째 훈련 데이터에 대한 반응 변수의 관측 값

f(xi)  : i번째 훈련 데이터에 대한 반응 변수의 예측 값



### 단순 선형 회귀를 위한 OLS의 계산

- 단순 선형 회귀 식 : y=α+ βx
- 비용 함수를 최소화 하는 α값과 β값을 찾는 것이  목표
- β를 계산하기 위해 x의 분산과 x와 y의 공분산을 계산

![image-20220504200711634](https://user-images.githubusercontent.com/102509786/166672639-ab7365a8-768f-4f54-9777-2adf9db3178d.png)

![image-20220504200717604](https://user-images.githubusercontent.com/102509786/166672643-b6a3a98c-ea1a-417e-86c5-947c2420c2f5.png)

x ̅  : x의 평균

x_i : x의 i번째 훈련 데이터의 값

y ̅ : y의 평균

y_i : y의 i번째 관측 값

n  : 훈련 데이터의 개수

- β의 값 계산 : ![image-20220504200802960](https://user-images.githubusercontent.com/102509786/166672647-cf3aa4d2-49d5-48a1-b3e9-a60c88c9fd8b.png)

- α의 값 계산 :![image-20220504200822428](https://user-images.githubusercontent.com/102509786/166672665-97e178ac-cb39-45e7-b457-3b86fa174227.png)

x ̅  : x의 평균

y ̅ : y의 평균

(x ̅ , y ̅ ) : 모델이 반드시 지나가야 하는 센트로이드 좌표



### 단순 선형 회귀 모델의 평가

- 회귀 모델의 기본 예측 능력 평가 지표 : 결정계수 R^2
- 데이터가 회귀선에 얼마나 가깝게 분포하는지를 측정
- 모델에 의해 설명된 반응 변수 분산의 비율을 기술 ->  0 <= R^2 <= 1
- R^2은 이상치에 민감하고, 모델에 새로운 특징이 추가되면 값이 증가하는 문제를 가짐



![image-20220504201136117](https://user-images.githubusercontent.com/102509786/166672677-2c49bf6e-3839-4b73-abc9-3b57ed4c3d26.png)

![image-20220504201153776](https://user-images.githubusercontent.com/102509786/166672682-1c7305d6-f5d5-4082-adfa-918ee9643218.png)

![image-20220504201159888](https://user-images.githubusercontent.com/102509786/166672688-2021cd67-a9ec-4dc7-8bb4-086e12702cea.png)

### 다중 선형 회귀의 개요

- 다중 선형 회귀란 설명 변수인 다수의 특징과 단일 반응 변수 간에 선형 관계가 있다고 가정하고 초평면이라고 하는 선형 평면을 이용해 모델링한 것
- 다중 회귀는 설명 변수의 n차원과 반응 변수의 1차원, 모두 n+1개의 차원을 가지며, 초평면은 한 차원 낮은 n차원이 됨

![image-20220504201315354](https://user-images.githubusercontent.com/102509786/166672694-2bff05c3-6fef-4510-80f9-05a9f45c311d.png)

y : 반응 변수의 예측 값

절편항  α와 계수 βn : 알고리즘을 통해 학습하게 되는 모델의 파라미터

 x_n : 설명 변수



### 다중 선형 회귀의 벡터 정리

- 선형 회귀 모델의 벡터 표기법

![image-20220504201544716](https://user-images.githubusercontent.com/102509786/166672700-5bc4248c-f5f7-4318-8e67-7ed4900f4cb1.png)

![image-20220504201550481](https://user-images.githubusercontent.com/102509786/166672707-ece42991-26c8-4f8f-a660-d7ed286c4fe7.png)

Y : 반응 변수의 예측 값을 가진 열 벡터

β : 알고리즘을 통해 학습하게 되는 모델의 파라미터 값을 갖는 열 벡터

X : 설명 변수 값을 갖는 m x n 차원 행렬로 m은 훈련 데이터의 개수,  n은 특징의 개수

- 훈련 데이터로부터 X와 Y의 값을 알고 있으므로 비용함수를 최소화하는  β를 계산



![image-20220504201733687](https://user-images.githubusercontent.com/102509786/166672718-7e09dde0-b8a4-4ca0-b112-4d136b9d2977.png)

![image-20220504201740205](https://user-images.githubusercontent.com/102509786/166672729-e5ca7cc6-098c-47ac-bfb4-6d0360da77bf.png)

Y : 반응 변수의 예측 값을 가진 열 벡터

β : 알고리즘을 통해 학습하게 되는 모델의 파라미터 값을 갖는 열 벡터

X : 설명 변수 값을 갖는 m x n 차원 행렬로 m은 훈련 데이터의 개수,  n은 특징의 개수

X^T : X의 전치행렬



## 다항 회귀

### 다중 회귀의 개요

- 다항 회귀란 반응 변수와 다항식으로 표현된 특징 사이의 선형 관계를 모델링 할 수 있는 다중 선형 회귀의 특수한 형태
- 특징을 변환한 후 다중 선형 회귀에서와 같은 방식으로 설명 변수와 반응 변수의 비선형 관계를 모델링 함
- 단일 설명 변수의 단일 특징을 사용하고 있지만 모델의 항은 n개

![image-20220504202134833](https://user-images.githubusercontent.com/102509786/166672741-30383f4c-af60-4b5c-950a-b34c99ec3216.png)

y : 반응 변수의 예측 값

절편항  α와 계수 βn : 알고리즘을 통해 학습하게 되는 모델의 파라미터

 x_n : 설명 변수